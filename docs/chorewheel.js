var DAYS=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],LOCAL_STORAGE_KEY_NAME="5f6e898b-9338-49d9-b1da-84e2609bae9d-chores",LOCAL_STORAGE_OLD_KEY_NAME="chores",DEFAULT_CHORES={chores:[{title:"Cook dinner",days:[0,1,2,3,4,5,6]},{title:"Dishes",days:[0,1,2,3,4,5,6]},{title:"Laundry",days:[6]},{title:"Meal prep",days:[0]},{title:"Put trash out",days:[3]},{title:"Call mom",days:[5]},{title:"Vacuum",days:[2]},{title:"Mop",days:[4]}],version:"2020-09-05",currentChoreStatus:null,currentDay:null,settings:{confetti:!0}};function getChores(){if(chores=JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY_NAME)),null===chores&&(console.log("Checking old name"),chores=JSON.parse(localStorage.getItem(LOCAL_STORAGE_OLD_KEY_NAME))),null!==chores)return void 0===chores.version?chores=upgradeLegacy(chores):"2020-09-05"===chores.version||console.log("Unknown version!"),chores;console.log("No chores, loading defaults"),chores=DEFAULT_CHORES;new Date;return chores.currentDay=(new Date).getDay(),loadChoresForDay(chores)}function upgradeLegacy(e){return e.version="2020-09-05",saveChores(e),localStorage.removeItem(LOCAL_STORAGE_OLD_KEY_NAME),e}function saveChores(e){localStorage.setItem(LOCAL_STORAGE_KEY_NAME,JSON.stringify(e))}function loadChoresForDay(e){e.currentChoreStatus=[];var t=e.currentDay;for(var o in e.chores){var r=e.chores[o];r.days.includes(t)&&e.currentChoreStatus.push({title:r.title,isDone:!1})}return saveChores(e),e}function showChores(){var e=document.querySelector("#wheel"),t=document.querySelector("h1"),o=getChores(),r=o.currentChoreStatus;for(t.innerHTML="Tasks for "+DAYS[o.currentDay];e.firstChild;)e.removeChild(e.lastChild);for(var n in r){var a=r[n],s=document.createElement("div");s.classList.add("task"),a.isDone&&s.classList.add("done"),s.innerHTML=a.title,s.addEventListener("click",tapTask),e.appendChild(s)}}function updateChoreCompletion(e,t){var o=getChores();for(var r in o.currentChoreStatus){var n=o.currentChoreStatus[r];n.title==e&&(n.isDone=t)}t&&checkWin(o),saveChores(o)}function tapTask(e){var t=!1;e.target.classList.contains("done")?e.target.classList.remove("done"):(e.target.classList.add("done"),t=!0),updateChoreCompletion(e.target.innerHTML,t)}function checkWin(e){for(var t in e.currentChoreStatus){if(!e.currentChoreStatus[t].isDone)return}onWin(e)}function onWin(e){confetti&&e.settings&&e.settings.confetti&&confetti.start(3e3)}function loadNextDay(){var e=getChores();dayOfWeek=e.currentDay,dayOfWeek=(dayOfWeek+1)%7,e.currentDay=dayOfWeek,loadChoresForDay(e)}function initChores(){var e=getChores();"#reload"===window.location.hash&&loadChoresForDay(e)}function connectButtons(){document.querySelector("#nextDay").addEventListener("click",function(){loadNextDay(),showChores()}),document.querySelector("#editChores").addEventListener("click",function(){window.location="edit.html"}),document.querySelector("#about").addEventListener("click",function(){window.location="about.html"})}window.onload=function(){navigator.serviceWorker.getRegistrations().then(function(e){for(var t=0;t<e.length;t++)e[t].unregister()}),connectButtons(),initChores(),showChores()};
//# sourceMappingURL=chorewheel.js.map