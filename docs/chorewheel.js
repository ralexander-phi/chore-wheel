var DAYS=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],LOCAL_STORAGE_KEY_NAME="5f6e898b-9338-49d9-b1da-84e2609bae9d-chores",LOCAL_STORAGE_OLD_KEY_NAME="chores",DEFAULT_CHORES={chores:[{title:"Cook dinner",days:[0,1,2,3,4,5,6]},{title:"Dishes",days:[0,1,2,3,4,5,6]},{title:"Laundry",days:[6]},{title:"Meal prep",days:[0]},{title:"Put trash out",days:[3]},{title:"Call mom",days:[5]},{title:"Vacuum",days:[2]},{title:"Mop",days:[4]}],reminders:[{title:"Edit to customize",snoozedUntil:null}],version:"2020-09-05",currentChoreStatus:null,currentDay:null,settings:{confetti:!0}};function getData(){var e=JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY_NAME));if(null===e&&(console.log("Checking old name"),e=JSON.parse(localStorage.getItem(LOCAL_STORAGE_OLD_KEY_NAME))),null!==e)return void 0===e.version?e=upgradeLegacy(e):"2020-09-05"===e.version?e=minorUpgrades(e):console.log("Unknown version!"),e;console.log("No chores, loading defaults"),e=DEFAULT_CHORES;new Date;return e.currentDay=(new Date).getDay(),loadChoresForDay(e)}function minorUpgrades(e){return void 0===e.settings&&(e.settings={}),void 0===e.settings.confetti&&(e.settings.confetti=!0),void 0===e.reminders&&(e.reminders=[]),saveData(e),e}function upgradeLegacy(e){return e.version="2020-09-05",saveData(e),localStorage.removeItem(LOCAL_STORAGE_OLD_KEY_NAME),e}function saveData(e){localStorage.setItem(LOCAL_STORAGE_KEY_NAME,JSON.stringify(e))}function loadChoresForDay(e){e.currentChoreStatus=[];var t=e.currentDay;for(var n in e.chores){var r=e.chores[n];r.days.includes(t)&&e.currentChoreStatus.push({title:r.title,isDone:!1})}for(var a in e.reminders){var i=e.reminders[a];i.snoozedUntil==e.currentDay&&(i.snoozedUntil=null)}return saveData(e),e}function show(){var e=document.querySelector("#wheel"),t=document.querySelector("#reminder"),n=document.querySelector("h1"),r=getData(),a=r.currentChoreStatus;for(n.innerHTML="Tasks for "+DAYS[r.currentDay];e.firstChild;)e.removeChild(e.lastChild);for(;t.firstChild;)t.removeChild(t.lastChild);if(0!=r.reminders.length)for(var i in r.reminders){var o,s,d,c,l,u,m=r.reminders[i];null===m.snoozedUntil&&((o=document.createElement("div")).classList.add("reminder"),(s=document.createElement("div")).classList.add("reminderText"),s.innerHTML=m.title,o.appendChild(s),(d=document.createElement("div")).classList.add("reminderButtons"),(c=document.createElement("div")).classList.add("button"),c.classList.add("snooze"),c.innerHTML="Snooze",c.addEventListener("click",generateTapSnooze(i)),d.appendChild(c),(l=document.createElement("div")).classList.add("buttonSep"),d.appendChild(l),(u=document.createElement("div")).classList.add("button"),u.classList.add("dismiss"),u.innerHTML="Dismiss",u.addEventListener("click",generateTapDismiss(i)),d.appendChild(u),o.appendChild(d),t.appendChild(o))}for(var v in a){var h=a[v],f=document.createElement("div");f.classList.add("task"),h.isDone&&f.classList.add("done"),f.innerHTML=h.title,f.addEventListener("click",tapTask),e.appendChild(f)}}function updateChoreCompletion(e,t){var n=getData();for(var r in n.currentChoreStatus){var a=n.currentChoreStatus[r];a.title==e&&(a.isDone=t)}t&&checkWin(n),saveData(n)}function tapTask(e){var t=!1;e.target.classList.contains("done")?e.target.classList.remove("done"):(e.target.classList.add("done"),t=!0),updateChoreCompletion(e.target.innerHTML,t)}function generateTapDismiss(n){return function(e){var t=getData();t.reminders.splice(n,1),saveData(t),show()}}function generateTapSnooze(n){return function(e){var t=getData();t.reminders[n].snoozedUntil=(t.currentDay+1)%7,saveData(t),show()}}function checkWin(e){for(var t in e.currentChoreStatus){if(!e.currentChoreStatus[t].isDone)return}onWin(e)}function onWin(e){confetti&&e.settings&&e.settings.confetti&&confetti.start(3e3)}function loadNextDay(){var e=getData();dayOfWeek=e.currentDay,dayOfWeek=(dayOfWeek+1)%7,e.currentDay=dayOfWeek,loadChoresForDay(e)}function connectButtons(){document.querySelector("#nextDay").addEventListener("click",function(){loadNextDay(),show()}),document.querySelector("#editChores").addEventListener("click",function(){window.location="edit.html"}),document.querySelector("#editReminders").addEventListener("click",function(){window.location="remind.html"}),document.querySelector("#about").addEventListener("click",function(){window.location="about.html"})}function init(){void 0!==navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then(function(e){for(var t=0;t<e.length;t++)e[t].unregister()})}window.onload=function(){init(),connectButtons(),show()};
//# sourceMappingURL=chorewheel.js.map